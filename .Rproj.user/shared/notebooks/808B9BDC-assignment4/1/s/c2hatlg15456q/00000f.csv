"0","df <- claimsize_df"
"0",""
"0",""
"0","# Ensure positivity"
"0","stopifnot(all(df$CLAIMS > 0), all(is.finite(df$CLAIMS)))"
"0",""
"0","# Make sure all categorical vars are factors, then drop unused levels"
"0","char_cols <- sapply(df, is.character)"
"0","df[char_cols] <- lapply(df[char_cols], factor)"
"0","df <- droplevels(df)"
"0",""
"0","upper_form <- CLAIMS ~ (AGE + GENDER + DRIVING_EXPERIENCE + EDUCATION +"
"0","                        CREDIT_SCORE + VEHICLE_OWNERSHIP + VEHICLE_YEAR +"
"0","                        MARRIED + CHILDREN + ANNUAL_MILEAGE +"
"0","                        VEHICLE_TYPE + SPEEDING_VIOLATIONS + PAST_ACCIDENTS)^2"
"0",""
"0","# Start with a converged base model (intercept + main effects is a good start)"
"0","base_form <- CLAIMS ~ AGE + GENDER + DRIVING_EXPERIENCE + EDUCATION +"
"0","                      CREDIT_SCORE + VEHICLE_OWNERSHIP + VEHICLE_YEAR +"
"0","                      MARRIED + CHILDREN + ANNUAL_MILEAGE +"
"0","                      VEHICLE_TYPE + SPEEDING_VIOLATIONS + PAST_ACCIDENTS"
"0",""
"0","gamma_base <- glm(base_form, family = Gamma(link = ""log""),"
"0","                  data = df, control = glm.control(maxit = 100))"
"0",""
"0","# Forward or both-direction stepwise within scope; pass control so refits get more iterations"
"0","gamma_step <- stats::step(gamma_base,"
"0","                   scope = list(lower = ~1, upper = upper_form),"
"0","                   direction = ""both"","
"0","                   trace = 0,"
"0","                   control = glm.control(maxit = 70))"
"0","summary(gamma_step)"
"1","
Call:
"
"1",""
"1","glm(formula = CLAIMS ~ GENDER + DRIVING_EXPERIENCE + CREDIT_SCORE + 
    VEHICLE_YEAR + MARRIED + CHILDREN + ANNUAL_MILEAGE + VEHICLE_TYPE + 
    SPEEDING_VIOLATIONS + PAST_ACCIDENTS + GENDER:CHILDREN + 
    CHILDREN:ANNUAL_MILEAGE + CREDIT_SCORE:PAST_ACCIDENTS + VEHICLE_YEAR:MARRIED + 
    GENDER:SPEEDING_VIOLATIONS + CREDIT_SCORE:VEHICLE_TYPE, family = Gamma(link = ""log""), 
    data = df, control = glm.control(maxit = 100))"
"1",""
"1","
"
"1","
Coefficients:
"
"1","                                   "
"1","   Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)                        "
"1","  8.764e+00"
"1","  2.361e-01"
"1","  37.126"
"1","  < 2e-16"
"1"," ***"
"1","
GENDERmale                         "
"1","  2.660e-01"
"1","  6.497e-02"
"1","   4.094"
"1"," 4.37e-05"
"1"," ***"
"1","
DRIVING_EXPERIENCE10-19y           "
"1"," -5.953e-01"
"1","  7.069e-02"
"1","  -8.422"
"1","  < 2e-16"
"1"," ***"
"1","
DRIVING_EXPERIENCE20-29y           "
"1"," -5.480e-01"
"1","  1.549e-01"
"1","  -3.537"
"1"," 0.000412"
"1"," ***"
"1","
DRIVING_EXPERIENCE30y+             "
"1"," -1.502e-01"
"1","  3.088e-01"
"1","  -0.486"
"1"," 0.626840"
"1","    "
"1","
CREDIT_SCORE                       "
"1","  4.418e-01"
"1","  1.950e-01"
"1","   2.266"
"1"," 0.023558"
"1"," *  "
"1","
VEHICLE_YEARbefore 2015            "
"1","  2.311e-01"
"1","  9.350e-02"
"1","   2.472"
"1"," 0.013510"
"1"," *  "
"1","
MARRIED                            "
"1","  2.449e-01"
"1","  1.430e-01"
"1","   1.713"
"1"," 0.086869"
"1"," .  "
"1","
CHILDREN                           "
"1"," -7.110e-01"
"1","  2.434e-01"
"1","  -2.921"
"1"," 0.003518"
"1"," ** "
"1","
ANNUAL_MILEAGE                     "
"1"," -2.069e-05"
"1","  1.366e-05"
"1","  -1.515"
"1"," 0.129961"
"1","    "
"1","
VEHICLE_TYPEsports car             "
"1","  7.186e-01"
"1","  3.624e-01"
"1","   1.983"
"1"," 0.047499"
"1"," *  "
"1","
SPEEDING_VIOLATIONS                "
"1"," -4.699e-02"
"1","  4.963e-02"
"1","  -0.947"
"1"," 0.343826"
"1","    "
"1","
PAST_ACCIDENTS                     "
"1","  1.749e-01"
"1","  1.134e-01"
"1","   1.543"
"1"," 0.123067"
"1","    "
"1","
GENDERmale:CHILDREN                "
"1","  2.082e-01"
"1","  8.995e-02"
"1","   2.315"
"1"," 0.020709"
"1"," *  "
"1","
CHILDREN:ANNUAL_MILEAGE            "
"1","  4.511e-05"
"1","  1.809e-05"
"1","   2.494"
"1"," 0.012702"
"1"," *  "
"1","
CREDIT_SCORE:PAST_ACCIDENTS        "
"1"," -4.260e-01"
"1","  2.275e-01"
"1","  -1.872"
"1"," 0.061255"
"1"," .  "
"1","
VEHICLE_YEARbefore 2015:MARRIED    "
"1"," -3.099e-01"
"1","  1.493e-01"
"1","  -2.076"
"1"," 0.037983"
"1"," *  "
"1","
GENDERmale:SPEEDING_VIOLATIONS     "
"1","  8.845e-02"
"1","  4.833e-02"
"1","   1.830"
"1"," 0.067357"
"1"," .  "
"1","
CREDIT_SCORE:VEHICLE_TYPEsports car"
"1"," -1.067e+00"
"1","  7.690e-01"
"1","  -1.387"
"1"," 0.165605"
"1","    "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
(Dispersion parameter for "
"1",""
"1","Gamma"
"1",""
"1"," family taken to be "
"1",""
"1","1.202638"
"1",""
"1",")

"
"1",""
"1","    Null deviance: 2963.2  on 2533  degrees of freedom
"
"1",""
"1","Residual deviance: 2695.0  on 2515  degrees of freedom
"
"1","AIC: "
"1",""
"1","50045"
"1",""
"1","

"
"1",""
"1","Number of Fisher Scoring iterations: "
"1",""
"1","6"
"1",""
"1","
"
"1","
"
