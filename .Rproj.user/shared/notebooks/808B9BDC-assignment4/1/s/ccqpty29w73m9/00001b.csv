"0",""
"0",""
"0","# 1. Select all numeric columns from train and test sets"
"0","train_numeric <- train_data_x %>% select(where(is.numeric))"
"0","test_numeric  <- test_data_x %>% select(where(is.numeric))"
"0",""
"0","# 2. Build recipe: Impute ONLY ANNUAL_MILEAGE and CREDIT_SCORE, using all numeric predictors"
"0","rec <- recipe(~ ., data = train_numeric) %>%"
"0","  step_impute_knn(c(""ANNUAL_MILEAGE"", ""CREDIT_SCORE""))"
"0",""
"0","# 3. Prep the recipe (fit on training data)"
"0","rec_prep <- prep(rec, training = train_numeric)"
"0",""
"0","# 4. Impute the training and test sets"
"0","train_imputed <- bake(rec_prep, new_data = train_numeric)"
"0","test_imputed  <- bake(rec_prep, new_data = test_numeric)"
"0",""
"0","# The result: train_imputed and test_imputed contain all numeric columns,"
"0","# with only ANNUAL_MILEAGE and CREDIT_SCORE imputed, using relationships with all numeric variables."
"0",""
"0","train_data_imputed <- train_data"
"0","train_data_imputed$ANNUAL_MILEAGE <- train_imputed$ANNUAL_MILEAGE"
"0","train_data_imputed$CREDIT_SCORE <- train_imputed$CREDIT_SCORE"
"0",""
"0","test_data_imputed <- test_data"
"0","test_data_imputed$ANNUAL_MILEAGE <- test_imputed$ANNUAL_MILEAGE"
"0","test_data_imputed$CREDIT_SCORE <- test_imputed$CREDIT_SCORE"
"0",""
