"0","# QQ Plot against Exponential (for tail diagnosis)"
"0","qqtail <- function(vec, col, add=FALSE, ...) {"
"0","  n <- length(vec)"
"0","  sorted <- sort(vec)"
"0","  k <- floor(0.1 * n)"
"0","  tail <- sorted[(n-k+1):n]"
"0","  qexp <- qexp(ppoints(k), rate=1/mean(tail - min(tail)))"
"0","  if (!add) {"
"0","    plot(qexp, tail, col=col, pch=16, xlab=""Theoretical Quantiles (Exp)"", "
"0","         ylab=""Sample Quantiles"", main=""QQ Plot (Tail)"", ...)"
"0","  } else {"
"0","    points(qexp, tail, col=col, pch=16)"
"0","  }"
"0","}"
"0",""
"0","qqtail(gamma_model_errors_tail, ""blue"")"
