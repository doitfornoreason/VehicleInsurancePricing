"0",""
"0","plot_data <- train_data %>%"
"0","  # Create a clear factor for whether the credit score is missing"
"0","  mutate(Credit_Score_Status = factor(ifelse(is.na(CREDIT_SCORE), ""Empty"", ""Not Empty""))) %>%"
"0","  # Count the occurrences of each vehicle year for each status"
"0","  count(VEHICLE_YEAR, Credit_Score_Status) %>%"
"0","  # Group by the status so we can calculate proportions within each group"
"0","  group_by(Credit_Score_Status) %>%"
"0","  # Calculate the proportion"
"0","  mutate(Proportion = n / sum(n))"
"0",""
"0",""
"0","# --- 4. Create the Side-by-Side Bar Plot ---"
"0",""
"0","ggplot(plot_data, aes(x = VEHICLE_YEAR, y = Proportion, fill = Credit_Score_Status)) +"
"0","  # geom_bar with stat=""identity"" uses the y-value directly."
"0","  # position=""dodge"" places the bars next to each other."
"0","  geom_bar(stat = ""identity"", position = ""dodge"") +"
"0","  "
"0","  labs("
"0","    title = ""Vehicle Year Distribution by Credit Score Availability"","
"0","    subtitle = ""Comparing proportions for policies with empty vs. non-empty credit scores"","
"0","    x = ""Vehicle Year"","
"0","    y = ""Proportion within Group"","
"0","    fill = ""Credit Score Status"""
"0","  ) +"
"0","  "
"0","  # Set the colors as requested"
"0","  scale_fill_manual(values = c(""Empty"" = ""gold"", ""Not Empty"" = ""dodgerblue"")) +"
"0","  "
"0","  # Improve readability"
"0","  theme_minimal() +"
"0","  theme(axis.text.x = element_text(angle = 45, hjust = 1))"
"0",""
