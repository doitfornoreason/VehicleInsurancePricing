"0","# kNN-impute numeric predictors and refit models on data_imputed"
"0",""
"0","# Predictors used by either model (exclude responses)"
"0","pred_vars <- setdiff("
"0","  unique(c(all.vars(formula(outcome.2.logistic))[-1],"
"0","           all.vars(formula(claimsize.2.gamma))[-1])),"
"0","  c(""OUTCOME"", ""CLAIMS"")"
"0",")"
"0",""
"0","# Numeric predictors to impute"
"0","num_vars <- intersect(pred_vars, names(Filter(is.numeric, data)))"
"0",""
"0","# Train kNN imputer (k = 5) on training numerics and impute"
"0","rec <- recipe(~ ., data = data[, num_vars, drop = FALSE]) |>"
"0","  step_impute_knn(all_predictors(), neighbors = 5)"
"0","imp <- prep(rec, training = data[, num_vars, drop = FALSE], retain = TRUE)"
"0",""
"0","data_imputed <- data"
"0","data_imputed[, num_vars] <- bake(imp, new_data = data[, num_vars, drop = FALSE])"
"0",""
"0",""
"0","# Refit models with identical specs on imputed data"
"0","claimsize.3.gamma  <- update(claimsize.2.gamma,  data = data_imputed[data_imputed$CLAIMS > 0, ])"
"0","outcome.3.logistic <- update(outcome.2.logistic, data = data_imputed)"
