"0",""
"0","# --- Plot 2: Mean Excess Plot ---"
"0",""
"0","mean_excess_func <- function(data) {"
"0","  thresholds <- unique(sort(data))"
"0","  excess <- sapply(thresholds, function(u) { mean(data[data > u] - u) })"
"0","  return(data.frame(threshold = thresholds, mean_excess = excess))"
"0","}"
"0","me_x <- mean_excess_func(vector1)"
"0","me_y <- mean_excess_func(vector2)"
"0","xlim_range_me <- range(c(me_x$threshold, me_y$threshold))"
"0","ylim_range_me <- range(c(me_x$mean_excess, me_y$mean_excess), na.rm = TRUE)"
"0","plot(me_x$threshold, me_x$mean_excess, type = ""l"", col = ""dodgerblue"", lwd = 2,"
"0","     xlim = c(0, 20000), ylim = ylim_range_me, main = ""Mean Excess Plot"","
"0","     xlab = ""Threshold (u)"", ylab = ""Mean Excess over Threshold e(u)"")"
